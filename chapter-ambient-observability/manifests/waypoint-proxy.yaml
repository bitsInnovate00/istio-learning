# Waypoint proxy for L7 processing in ambient mode
# Deploy this when you need advanced L7 features like authorization policies
apiVersion: gateway.networking.k8s.io/v1beta1
kind: Gateway
metadata:
  name: bookinfo-waypoint
  namespace: bookinfo
  labels:
    istio.io/waypoint-for: service
spec:
  gatewayClassName: istio-waypoint
  listeners:
  - name: mesh
    port: 15008
    protocol: HBONE
---
# Label services that need L7 processing
apiVersion: v1
kind: Service
metadata:
  name: productpage
  namespace: bookinfo
  labels:
    istio.io/use-waypoint: bookinfo-waypoint
spec:
  # ... rest of service definition
